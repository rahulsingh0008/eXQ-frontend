<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eXQ - Academic Problem Solving Platform</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav id="navbar" class="navbar hidden">
        <div class="container">
            <div class="nav-brand">
                <h2>eXQ</h2>
                <span class="nav-subtitle">Academic Hub</span>
            </div>
            <div class="nav-menu">
                <a href="#" onclick="showPage('homepage')" class="nav-link">Homepage</a>
                <a href="#" onclick="showPage('problems')" class="nav-link">Problem Store</a>
                <a href="#" onclick="showPage('leaderboard')" class="nav-link">Leaderboard</a>
                <div class="nav-user">
                    <span id="userRole" class="user-role"></span>
                    <button onclick="logout()" class="btn btn-danger btn-sm">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login/Register Page -->
    <div id="authPage" class="auth-page">
        <div class="auth-container">
            <div class="auth-header">
                <h1>eXQ</h1>
                <p>Academic Problem Solving Platform</p>
            </div>
            
            <div class="auth-card">
                <h2 id="authTitle">Welcome Back</h2>
                
                <div id="errorMessage" class="error-message hidden"></div>
                
                <form id="authForm">
                    <!-- Register Fields -->
                    <div id="registerFields" class="hidden">
                        <div class="form-group">
                            <label>Full Name</label>
                            <input type="text" id="regName" class="form-control" placeholder="John Doe">
                        </div>
                        
                        <div class="form-group">
                            <label>Role</label>
                            <select id="regRole" class="form-control" onchange="toggleRoleFields()">
                                <option value="student">Student</option>
                                <option value="faculty">Faculty</option>
                            </select>
                        </div>
                        
                        <div id="studentFields">
                            <div class="form-group">
                                <label>Roll Number</label>
                                <input type="text" id="regRollNumber" class="form-control" placeholder="2021001">
                            </div>
                            
                            <div class="form-group">
                                <label>Year</label>
                                <select id="regYear" class="form-control">
                                    <option value="1">1st Year</option>
                                    <option value="2">2nd Year</option>
                                    <option value="3">3rd Year</option>
                                    <option value="4">4th Year</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Department</label>
                            <input type="text" id="regDepartment" class="form-control" placeholder="Computer Science">
                        </div>
                    </div>
                    
                    <!-- Common Fields -->
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="email" class="form-control" placeholder="you@example.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="password" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    
                    <button type="submit" id="authButton" class="btn btn-primary btn-block">Sign In</button>
                </form>
                
                <div class="auth-toggle">
                    <button onclick="toggleAuthMode()" id="toggleButton" class="btn-link">
                        Don't have an account? Sign Up
                    </button>
                </div>
                
                <div class="demo-credentials">
                    <p><strong>Demo Credentials:</strong></p>
                    <small>Student: student@test.com / password123</small><br>
                    <small>Faculty: faculty@test.com / password123</small><br>
                    <small>Admin: admin@test.com / password123</small>
                </div>
            </div>
        </div>
    </div>

        <!-- Profile Page -->
    <div id="profilePage" class="page hidden">
    <div class="container">
        <div class="page-header">
        <h1>Profile</h1>
        <p>View and edit your account details</p>
        </div>

        <div id="profileContent">
        <div class="content-card">
            <h3>Profile Details</h3>
            <div id="profileDetails" style="padding-top: 1rem;"></div>
        </div>

        <div class="content-card" style="margin-top:1rem;">
            <h3>Purchased Problems</h3>
            <div id="purchasedProblemsList" style="padding-top: 1rem;"></div>
        </div>
        </div>
    </div>
    </div>

    <!-- Main App Container -->
    <div id="appContainer" class="hidden">
        <!-- Student Homepage -->
        <div id="homepagePage" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h1>Welcome back <span id="dashboardUserName"></span>! üëã</h1>
                    <p id="dashboardUserInfo"></p>
                </div>
                
                <!-- <div class="stats-grid">
                    <div class="stat-card stat-blue">
                        <div class="stat-content">
                            <p class="stat-label">Team Members</p>
                            <p class="stat-value" id="teamMembersCount">0</p>
                        </div>
                        <i class="fas fa-users stat-icon"></i>
                    </div>
                    
                    <div class="stat-card stat-green">
                        <div class="stat-content">
                            <p class="stat-label">Posted Problems</p>
                            <p class="stat-value" id="postedProblemsCount">0</p>
                        </div>
                        <i class="fas fa-file-alt stat-icon"></i>
                    </div>
                    
                    <div class="stat-card stat-purple">
                        <div class="stat-content">
                            <p class="stat-label">Purchased Problems</p>
                            <p class="stat-value" id="purchasedProblemsCount">0</p>
                        </div>
                        <i class="fas fa-shopping-cart stat-icon"></i>
                    </div>
                </div> -->
                
                <div class="quick-actions student-only">
                    <h2>Quick Actions</h2>
                    <div class="action-grid">
                        <button onclick="showPage('team')" class="action-btn">
                            <i class="fas fa-users"></i>
                            <span>Create or Join a Team</span>
                        </button>
                        <button onclick="showPostProblemModal()" class="action-btn">
                            <i class="fas fa-plus"></i>
                            <span>Post Problem</span>
                        </button>
                    </div>
                </div>
                <!-- Teams preview / clickable cards (populated by homepage.js) -->
                <div id="homepageTeamsSection"></div>
                
                <!-- <div class="dashboard-content">
                    <div class="content-card">
                        <h3>My Recent Problems</h3>
                        <div id="myProblemsList"></div>
                    </div>
                    
                    <div class="content-card">
                        <h3>Recently Purchased</h3>
                        <div id="purchasedProblemsList"></div>
                    </div>
                </div> -->
            </div>
        </div>

        <!-- Problem Store Page -->
        <div id="problemsPage" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h1>Problem Store üè™</h1>
                    <p>Browse and purchase academic problems with solutions</p>
                </div>
                
                <div class="filters-card">
                    <div class="filters-grid">
                        <select id="domainsFilter" class="form-control">
                            <option value="">All Domains</option>
                        </select>
                        
                        <select id="sortFilter" class="form-control">
                            <option value="latest">Latest</option>
                            <option value="popular">Most Popular</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                        </select>
                    </div>
                </div>
                
                <div id="problemsGrid" class="problems-grid"></div>
                <div id="loadingProblems" class="loading hidden">Loading...</div>
            </div>
        </div>

        <!-- Team Page -->
        <div id="teamPage" class="page hidden">
            <div class="container">
                <div id="noTeamSection">
                    <div class="no-team-card">
                        <h2>You're not part of a team yet</h2>
                        <div class="team-actions">
                            <button onclick="showCreateTeamModal()" class="btn btn-primary">Create New Team</button>
                            <div class="join-team-section">
                                <input type="text" id="inviteCodeInput" class="form-control" placeholder="Enter invite code">
                                <button onclick="joinTeam()" class="btn btn-success">Join Team</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="teamSection" class="hidden">
                    <div class="team-layout">
                        <div class="team-sidebar">
                            <div class="team-info-card">
                                <h2 id="teamName"></h2>
                                <p id="teamDescription"></p>
                                <div class="team-details">
                                    <p><strong>Invite Code:</strong> <span id="teamInviteCode"></span></p>
                                    <p><strong>Members:</strong> <span id="teamMemberCount"></span></p>
                                </div>
                                <div class="team-members-list" id="teamMembersList"></div>
                                <button onclick="leaveTeam()" class="btn btn-danger btn-sm">Leave Team</button>
                            </div>
                        </div>
                        
                        <div class="team-chat">
                            <div class="chat-card">
                                <div class="chat-header">
                                    <h3>Team Chat</h3>
                                    <span id="chatStatus" class="chat-status">‚óè</span>
                                </div>
                                <div class="chat-messages" id="chatMessages"></div>
                                <div id="typingIndicator" class="typing-indicator hidden"></div>
                                <form id="chatForm" class="chat-input">
                                    <input type="text" id="chatMessageInput" class="form-control" placeholder="Type a message...">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Teams List (Faculty) -->
        <div id="teamsListPage" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h1>Student Teams</h1>
                    <p>View and manage all student teams</p>
                </div>
                <div id="teamsListGrid" class="teams-grid"></div>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboardPage" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h1>Admin Dashboard</h1>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card stat-blue">
                        <div class="stat-content">
                            <p class="stat-label">Total Users</p>
                            <p class="stat-value" id="adminTotalUsers">0</p>
                        </div>
                        <i class="fas fa-users stat-icon"></i>
                    </div>
                    
                    <div class="stat-card stat-green">
                        <div class="stat-content">
                            <p class="stat-label">Total Teams</p>
                            <p class="stat-value" id="adminTotalTeams">0</p>
                        </div>
                        <i class="fas fa-users-cog stat-icon"></i>
                    </div>
                    
                    <div class="stat-card stat-purple">
                        <div class="stat-content">
                            <p class="stat-label">Total Problems</p>
                            <p class="stat-value" id="adminTotalProblems">0</p>
                        </div>
                        <i class="fas fa-file-alt stat-icon"></i>
                    </div>
                    
                    <div class="stat-card stat-orange">
                        <div class="stat-content">
                            <p class="stat-label">Revenue</p>
                            <p class="stat-value" id="adminRevenue">‚Çπ0</p>
                        </div>
                        <i class="fas fa-rupee-sign stat-icon"></i>
                    </div>
                </div>
                
                <div class="admin-tabs">
                    <button class="tab-btn active" onclick="showAdminTab('users')">Users</button>
                    <button class="tab-btn" onclick="showAdminTab('problems')">Problems</button>
                    <button class="tab-btn" onclick="showAdminTab('payments')">Payments</button>
                </div>
                
                <div id="adminUsersTab" class="admin-tab-content">
                    <div id="adminUsersList"></div>
                </div>
                
                <div id="adminProblemsTab" class="admin-tab-content hidden">
                    <div id="adminProblemsList"></div>
                </div>
                
                <div id="adminPaymentsTab" class="admin-tab-content hidden">
                    <div id="adminPaymentsList"></div>
                </div>
            </div>
        </div>

        <!-- Faculty Leaderboard Page -->
        <div id="leaderboardPage" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h1>Faculty Leaderboard</h1>
                    <p>Top faculty based on assigned teams, feedback, and upvotes given</p>
                </div>
                <div class="content-card">
                    <div id="facultyLeaderboardList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="modalOverlay" class="modal-overlay hidden" onclick="closeModal()"></div>
    
    <!-- Problem Detail Modal -->
    <div id="problemDetailModal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <h2 id="modalProblemTitle"></h2>
            <div id="modalProblemContent"></div>
        </div>
    </div>

    <!-- Create Team Modal -->
    <div id="createTeamModal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <h2>Create New Team</h2>
            <form id="createTeamForm">
                <div class="form-group">
                    <label>Team Name</label>
                    <input type="text" id="teamNameInput" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="teamDescInput" class="form-control" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Max Members</label>
                    <input type="number" id="teamMaxInput" class="form-control" value="5" min="2" max="10">
                </div>
                <button type="submit" class="btn btn-primary">Create Team</button>
            </form>
        </div>
    </div>

    <!-- Post Problem Modal -->
    <div id="postProblemModal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <h2>Post New Problem</h2>
            <form id="postProblemForm">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="problemTitle" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="problemDesc" class="form-control" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <input type="text" id="problemCategory" class="form-control" placeholder="e.g., DSA, Web Dev" required>
                </div>
                <div class="form-group">
                    <label>Subject</label>
                    <input type="text" id="problemSubject" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Difficulty</label>
                    <select id="problemDifficulty" class="form-control">
                        <option value="Easy">Easy</option>
                        <option value="Medium">Medium</option>
                        <option value="Hard">Hard</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Solution</label>
                    <textarea id="problemSolution" class="form-control" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>Price (‚Çπ)</label>
                    <input type="number" id="problemPrice" class="form-control" value="60" min="0">
                </div>
                <button type="submit" class="btn btn-primary">Post Problem</button>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/socket.js"></script>
    <script src="js/homepage.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/problems.js"></script>
    <script src="js/team.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/app.js"></script>
</body>
</html>